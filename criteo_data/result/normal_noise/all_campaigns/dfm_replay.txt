  0%|          | 0/213 [00:00<?, ?it/s]  0%|          | 1/213 [00:30<1:49:12, 30.91s/it]  1%|          | 2/213 [00:58<1:45:11, 29.91s/it]  1%|▏         | 3/213 [01:21<1:37:27, 27.84s/it]  2%|▏         | 4/213 [01:42<1:29:59, 25.84s/it]  2%|▏         | 5/213 [02:02<1:23:17, 24.03s/it]  3%|▎         | 6/213 [02:22<1:18:36, 22.78s/it]  3%|▎         | 7/213 [02:48<1:21:14, 23.66s/it]  4%|▍         | 8/213 [03:11<1:20:39, 23.61s/it]  4%|▍         | 9/213 [03:30<1:15:44, 22.28s/it]  5%|▍         | 10/213 [03:54<1:16:42, 22.67s/it]  5%|▌         | 11/213 [04:15<1:14:45, 22.21s/it]  6%|▌         | 12/213 [04:33<1:10:26, 21.03s/it]  6%|▌         | 13/213 [04:50<1:05:27, 19.64s/it]  7%|▋         | 14/213 [05:08<1:03:41, 19.20s/it]  7%|▋         | 15/213 [05:28<1:03:54, 19.37s/it]  8%|▊         | 16/213 [05:46<1:02:45, 19.12s/it]  8%|▊         | 17/213 [06:05<1:02:31, 19.14s/it]  8%|▊         | 18/213 [06:24<1:01:20, 18.87s/it]  9%|▉         | 19/213 [06:44<1:02:11, 19.23s/it]  9%|▉         | 20/213 [07:04<1:02:57, 19.57s/it] 10%|▉         | 21/213 [07:28<1:06:52, 20.90s/it] 10%|█         | 22/213 [07:46<1:03:35, 19.98s/it] 11%|█         | 23/213 [08:07<1:04:48, 20.47s/it] 11%|█▏        | 24/213 [08:29<1:05:05, 20.67s/it] 12%|█▏        | 25/213 [08:50<1:05:29, 20.90s/it] 12%|█▏        | 26/213 [09:12<1:06:30, 21.34s/it] 13%|█▎        | 27/213 [09:31<1:03:32, 20.50s/it] 13%|█▎        | 28/213 [09:51<1:03:08, 20.48s/it] 14%|█▎        | 29/213 [10:14<1:04:38, 21.08s/it] 14%|█▍        | 30/213 [10:37<1:05:57, 21.63s/it] 15%|█▍        | 31/213 [10:58<1:05:09, 21.48s/it] 15%|█▌        | 32/213 [11:16<1:02:10, 20.61s/it] 15%|█▌        | 33/213 [11:33<58:00, 19.33s/it]   16%|█▌        | 34/213 [11:54<59:15, 19.86s/it] 16%|█▋        | 35/213 [12:15<59:38, 20.10s/it] 17%|█▋        | 36/213 [12:30<54:49, 18.59s/it] 17%|█▋        | 37/213 [12:48<54:28, 18.57s/it] 18%|█▊        | 38/213 [13:07<54:12, 18.59s/it] 18%|█▊        | 39/213 [13:30<58:08, 20.05s/it] 19%|█▉        | 40/213 [13:48<55:59, 19.42s/it] 19%|█▉        | 41/213 [14:12<59:53, 20.89s/it] 20%|█▉        | 42/213 [14:35<1:00:37, 21.27s/it] 20%|██        | 43/213 [14:51<56:28, 19.93s/it]   21%|██        | 44/213 [15:09<54:01, 19.18s/it] 21%|██        | 45/213 [15:41<1:04:14, 22.94s/it] 22%|██▏       | 46/213 [16:03<1:03:36, 22.85s/it] 22%|██▏       | 47/213 [16:21<59:21, 21.45s/it]   23%|██▎       | 48/213 [16:45<1:01:01, 22.19s/it] 23%|██▎       | 49/213 [17:05<58:16, 21.32s/it]   23%|██▎       | 50/213 [17:29<1:00:48, 22.38s/it] 24%|██▍       | 51/213 [17:48<57:04, 21.14s/it]   24%|██▍       | 52/213 [18:09<57:05, 21.27s/it] 25%|██▍       | 53/213 [18:33<58:25, 21.91s/it] 25%|██▌       | 54/213 [18:55<58:46, 22.18s/it] 26%|██▌       | 55/213 [19:20<1:00:32, 22.99s/it] 26%|██▋       | 56/213 [19:47<1:02:46, 23.99s/it] 27%|██▋       | 57/213 [20:04<57:28, 22.11s/it]   27%|██▋       | 58/213 [20:22<53:48, 20.83s/it] 28%|██▊       | 59/213 [20:46<56:04, 21.85s/it] 28%|██▊       | 60/213 [21:07<54:26, 21.35s/it] 29%|██▊       | 61/213 [21:27<53:24, 21.08s/it] 29%|██▉       | 62/213 [21:48<52:44, 20.96s/it] 30%|██▉       | 63/213 [22:04<48:49, 19.53s/it] 30%|███       | 64/213 [22:18<44:30, 17.92s/it] 31%|███       | 65/213 [22:37<44:55, 18.21s/it] 31%|███       | 66/213 [22:56<45:27, 18.56s/it] 31%|███▏      | 67/213 [23:21<49:19, 20.27s/it] 32%|███▏      | 68/213 [23:42<49:23, 20.44s/it] 32%|███▏      | 69/213 [23:56<44:46, 18.66s/it] 33%|███▎      | 70/213 [24:18<46:40, 19.58s/it] 33%|███▎      | 71/213 [24:32<42:49, 18.09s/it] 34%|███▍      | 72/213 [24:49<41:42, 17.75s/it] 34%|███▍      | 73/213 [25:05<39:42, 17.02s/it] 35%|███▍      | 74/213 [25:28<43:53, 18.95s/it] 35%|███▌      | 75/213 [25:51<46:20, 20.15s/it] 36%|███▌      | 76/213 [26:14<47:44, 20.91s/it] 36%|███▌      | 77/213 [26:35<47:44, 21.06s/it] 37%|███▋      | 78/213 [26:57<47:55, 21.30s/it] 37%|███▋      | 79/213 [27:19<47:48, 21.41s/it] 38%|███▊      | 80/213 [27:38<46:24, 20.93s/it] 38%|███▊      | 81/213 [27:57<44:35, 20.27s/it] 38%|███▊      | 82/213 [28:13<41:12, 18.88s/it] 39%|███▉      | 83/213 [28:33<41:43, 19.26s/it] 39%|███▉      | 84/213 [28:58<45:14, 21.04s/it] 40%|███▉      | 85/213 [29:18<44:00, 20.63s/it] 40%|████      | 86/213 [29:37<42:51, 20.25s/it] 41%|████      | 87/213 [30:01<44:42, 21.29s/it] 41%|████▏     | 88/213 [30:25<45:49, 22.00s/it] 42%|████▏     | 89/213 [30:45<44:13, 21.40s/it] 42%|████▏     | 90/213 [31:07<44:39, 21.78s/it] 43%|████▎     | 91/213 [31:27<42:59, 21.14s/it] 43%|████▎     | 92/213 [31:47<41:51, 20.76s/it] 44%|████▎     | 93/213 [32:03<38:53, 19.45s/it] 44%|████▍     | 94/213 [32:19<36:31, 18.42s/it] 45%|████▍     | 95/213 [32:38<36:22, 18.50s/it] 45%|████▌     | 96/213 [32:56<36:05, 18.51s/it] 46%|████▌     | 97/213 [33:14<35:16, 18.25s/it] 46%|████▌     | 98/213 [33:34<35:47, 18.67s/it] 46%|████▋     | 99/213 [33:52<35:03, 18.45s/it] 47%|████▋     | 100/213 [34:14<36:57, 19.63s/it] 47%|████▋     | 101/213 [34:34<36:36, 19.61s/it] 48%|████▊     | 102/213 [34:53<36:26, 19.70s/it] 48%|████▊     | 103/213 [35:12<35:28, 19.35s/it] 49%|████▉     | 104/213 [35:32<35:19, 19.45s/it] 49%|████▉     | 105/213 [35:52<35:26, 19.69s/it] 50%|████▉     | 106/213 [36:11<34:33, 19.38s/it] 50%|█████     | 107/213 [36:28<33:12, 18.80s/it] 51%|█████     | 108/213 [36:49<33:58, 19.41s/it] 51%|█████     | 109/213 [37:05<31:59, 18.45s/it] 52%|█████▏    | 110/213 [37:26<32:53, 19.16s/it] 52%|█████▏    | 111/213 [37:49<34:28, 20.28s/it] 53%|█████▎    | 112/213 [38:10<34:44, 20.64s/it] 53%|█████▎    | 113/213 [38:32<35:04, 21.05s/it] 54%|█████▎    | 114/213 [38:53<34:38, 20.99s/it] 54%|█████▍    | 115/213 [39:21<37:29, 22.96s/it] 54%|█████▍    | 116/213 [39:39<34:53, 21.58s/it] 55%|█████▍    | 117/213 [40:01<34:29, 21.56s/it] 55%|█████▌    | 118/213 [40:18<32:07, 20.29s/it] 56%|█████▌    | 119/213 [40:40<32:33, 20.79s/it] 56%|█████▋    | 120/213 [41:01<32:28, 20.95s/it] 57%|█████▋    | 121/213 [41:22<32:10, 20.98s/it] 57%|█████▋    | 122/213 [41:41<30:49, 20.33s/it] 58%|█████▊    | 123/213 [42:05<32:11, 21.47s/it] 58%|█████▊    | 124/213 [42:27<32:11, 21.70s/it] 59%|█████▊    | 125/213 [42:47<30:55, 21.09s/it] 59%|█████▉    | 126/213 [43:05<29:00, 20.00s/it] 60%|█████▉    | 127/213 [43:24<28:25, 19.83s/it] 60%|██████    | 128/213 [43:42<27:12, 19.21s/it] 61%|██████    | 129/213 [44:03<27:48, 19.86s/it] 61%|██████    | 130/213 [44:18<25:19, 18.30s/it] 62%|██████▏   | 131/213 [44:45<28:29, 20.84s/it] 62%|██████▏   | 132/213 [45:07<28:36, 21.19s/it] 62%|██████▏   | 133/213 [45:19<24:37, 18.47s/it] 63%|██████▎   | 134/213 [45:40<25:24, 19.30s/it] 63%|██████▎   | 135/213 [45:57<24:23, 18.76s/it] 64%|██████▍   | 136/213 [46:18<24:47, 19.32s/it] 64%|██████▍   | 137/213 [46:35<23:43, 18.74s/it] 65%|██████▍   | 138/213 [46:54<23:13, 18.58s/it] 65%|██████▌   | 139/213 [47:12<22:54, 18.57s/it] 66%|██████▌   | 140/213 [47:38<25:13, 20.73s/it] 66%|██████▌   | 141/213 [47:58<24:40, 20.57s/it] 67%|██████▋   | 142/213 [48:19<24:25, 20.64s/it] 67%|██████▋   | 143/213 [48:44<25:28, 21.84s/it] 68%|██████▊   | 144/213 [49:09<26:15, 22.83s/it] 68%|██████▊   | 145/213 [49:28<24:45, 21.84s/it] 69%|██████▊   | 146/213 [49:52<25:08, 22.52s/it] 69%|██████▉   | 147/213 [50:09<22:50, 20.76s/it] 69%|██████▉   | 148/213 [50:29<22:21, 20.63s/it] 70%|██████▉   | 149/213 [50:52<22:41, 21.27s/it] 70%|███████   | 150/213 [51:17<23:28, 22.35s/it] 71%|███████   | 151/213 [51:40<23:18, 22.56s/it] 71%|███████▏  | 152/213 [52:00<22:08, 21.78s/it] 72%|███████▏  | 153/213 [52:22<21:52, 21.87s/it] 72%|███████▏  | 154/213 [52:46<22:00, 22.38s/it] 73%|███████▎  | 155/213 [53:05<20:45, 21.48s/it] 73%|███████▎  | 156/213 [53:26<20:18, 21.38s/it] 74%|███████▎  | 157/213 [53:49<20:27, 21.92s/it] 74%|███████▍  | 158/213 [54:12<20:15, 22.10s/it] 75%|███████▍  | 159/213 [54:37<20:42, 23.02s/it] 75%|███████▌  | 160/213 [55:08<22:30, 25.47s/it] 76%|███████▌  | 161/213 [55:28<20:36, 23.78s/it] 76%|███████▌  | 162/213 [55:51<19:56, 23.46s/it] 77%|███████▋  | 163/213 [56:10<18:24, 22.10s/it] 77%|███████▋  | 164/213 [56:31<17:52, 21.89s/it] 77%|███████▋  | 165/213 [56:53<17:24, 21.76s/it] 78%|███████▊  | 166/213 [57:14<16:54, 21.59s/it] 78%|███████▊  | 167/213 [57:29<15:07, 19.74s/it] 79%|███████▉  | 168/213 [57:52<15:27, 20.62s/it] 79%|███████▉  | 169/213 [58:20<16:50, 22.96s/it] 80%|███████▉  | 170/213 [58:43<16:18, 22.76s/it] 80%|████████  | 171/213 [59:08<16:28, 23.54s/it] 81%|████████  | 172/213 [59:30<15:46, 23.09s/it] 81%|████████  | 173/213 [59:50<14:46, 22.17s/it] 82%|████████▏ | 174/213 [1:00:11<14:11, 21.83s/it] 82%|████████▏ | 175/213 [1:00:32<13:34, 21.45s/it] 83%|████████▎ | 176/213 [1:00:45<11:46, 19.10s/it] 83%|████████▎ | 177/213 [1:01:05<11:39, 19.44s/it] 84%|████████▎ | 178/213 [1:01:25<11:25, 19.57s/it] 84%|████████▍ | 179/213 [1:01:45<11:06, 19.59s/it] 85%|████████▍ | 180/213 [1:02:02<10:24, 18.93s/it] 85%|████████▍ | 181/213 [1:02:21<10:01, 18.80s/it] 85%|████████▌ | 182/213 [1:02:41<09:55, 19.22s/it] 86%|████████▌ | 183/213 [1:03:03<10:05, 20.18s/it] 86%|████████▋ | 184/213 [1:03:25<10:00, 20.70s/it] 87%|████████▋ | 185/213 [1:03:51<10:22, 22.24s/it] 87%|████████▋ | 186/213 [1:04:10<09:34, 21.28s/it] 88%|████████▊ | 187/213 [1:04:29<08:53, 20.52s/it] 88%|████████▊ | 188/213 [1:04:48<08:22, 20.11s/it] 89%|████████▊ | 189/213 [1:05:07<07:51, 19.65s/it] 89%|████████▉ | 190/213 [1:05:28<07:44, 20.18s/it] 90%|████████▉ | 191/213 [1:05:53<07:52, 21.47s/it] 90%|█████████ | 192/213 [1:06:16<07:42, 22.01s/it] 91%|█████████ | 193/213 [1:06:36<07:07, 21.39s/it] 91%|█████████ | 194/213 [1:06:50<06:03, 19.14s/it] 92%|█████████▏| 195/213 [1:07:16<06:21, 21.21s/it] 92%|█████████▏| 196/213 [1:07:47<06:50, 24.13s/it] 92%|█████████▏| 197/213 [1:08:05<05:56, 22.30s/it] 93%|█████████▎| 198/213 [1:08:24<05:21, 21.42s/it] 93%|█████████▎| 199/213 [1:08:43<04:47, 20.53s/it] 94%|█████████▍| 200/213 [1:08:56<04:00, 18.51s/it] 94%|█████████▍| 201/213 [1:09:15<03:44, 18.71s/it] 95%|█████████▍| 202/213 [1:09:28<03:04, 16.78s/it] 95%|█████████▌| 203/213 [1:09:44<02:47, 16.76s/it] 96%|█████████▌| 204/213 [1:10:05<02:39, 17.77s/it] 96%|█████████▌| 205/213 [1:10:13<02:00, 15.10s/it] 97%|█████████▋| 206/213 [1:10:36<02:00, 17.18s/it] 97%|█████████▋| 207/213 [1:10:55<01:47, 17.88s/it] 98%|█████████▊| 208/213 [1:11:15<01:33, 18.64s/it] 98%|█████████▊| 209/213 [1:11:31<01:10, 17.67s/it] 99%|█████████▊| 210/213 [1:11:52<00:56, 18.83s/it] 99%|█████████▉| 211/213 [1:12:14<00:39, 19.57s/it]100%|█████████▉| 212/213 [1:12:42<00:22, 22.12s/it]100%|██████████| 213/213 [1:12:57<00:00, 19.94s/it]100%|██████████| 213/213 [1:12:57<00:00, 20.55s/it]
  0%|          | 0/213 [00:00<?, ?it/s]  0%|          | 0/213 [00:00<?, ?it/s]
DFM [1087.5535852451803, 1155.8531169940034, 1101.5270918136478, 1221.216619774941, 1130.7616001734568, 1087.574820788542, 1208.8374069319611, 1231.9339225589322, 1190.9250000000152, 1221.2403722978256, 1205.8801529961615, 1268.063211198011, 1251.1026412776544, 1244.1522714343655, 1247.2937132645347, 1136.951135316297, 1215.9817384036853, 1207.057044985547, 1246.2348035284524, 1246.9035318969056, 1156.764982653971, 1235.069073311361, 1169.8621918976517, 1239.1298001631367, 1161.8516018795615, 1110.4617848970247, 1260.2624910179518, 1240.9816283924656, 1192.9623731656307, 1254.1098404908105, 1210.9973739057789, 1193.9624150943664, 1275.0493360824896, 1237.2217677782423, 1271.35485837925, 1187.7927178602224, 1252.182135058635, 1285.2124326497778, 1252.1489593495667, 1256.0831622176959, 1180.9097927242192, 1230.082268803925, 1139.6474103585929, 1190.6475927561967, 1204.0518546055164, 1138.642410279096, 1192.8871167728407, 1147.747255328385, 1188.710677743783, 1152.6072147950258, 1033.2928173667126, 1140.4970922308225, 1125.6691358024732, 1152.7673168617453, 1144.6924989020622, 1146.631566799822, 1191.952414951725, 1130.7160034980507, 1215.885653650268, 1149.7769277369391, 1193.848615384613, 1150.7647224631473, 1200.937263157921, 1271.0970720720682, 1253.9165613147593, 1217.8046775580171, 1226.8821519524447, 1157.7323680767838, 1143.7074463425436, 1275.2996785713976, 1216.9610649895208, 1210.9207260447395, 1243.9726254180473, 1178.7658517555296, 1147.8891942323776, 1253.1642051905892, 1166.8960491733749, 1149.8061816616587, 1116.7919431279927, 1220.1171311810533, 1171.0230306799197, 1178.8599957337924, 1200.868121805766, 1245.9094976783572, 1160.851473729192, 1132.7644560034798, 1209.9568443138642, 1238.1997419354764, 1254.1332029340056, 1173.9671691792319, 1125.712685914254, 1163.7370196078766, 1170.9112050739777, 1214.1456201708052, 1273.149735987004, 1116.5550000000067, 1154.840872913991, 1173.892032244385, 1169.7822568093397, 1160.7143700787694, 1273.1550284090943, 1180.042290202554, 1305.32043083002, 1243.9618927972929, 1199.9574737725568, 1198.7847107080986, 1133.8494238156136, 1137.8108684436897, 1202.952322553552, 1170.81999570449, 1220.0700000000152, 1188.9299620573004, 1141.7710177565764, 1169.7822568093434, 1177.7478956521875, 1227.7246367986036, 1295.3844361785436, 1171.997542690529, 1194.047999999996, 1142.795316946981, 1093.472306989506, 1149.8614151747543, 1142.6345563442642, 1161.7649609713844, 1175.8474989311708, 1122.5924899418678, 1201.9599328858753, 1170.8597909556129, 1264.2115331991672, 1149.6388652482515, 1202.9850000000167, 1268.0632111980115, 1105.552003601958, 1155.7773691042594, 1211.0672023073794, 1219.8818428874715, 1175.7378919860664, 1173.8993898305275, 1199.6981611208307, 1126.6274100399696, 1191.7970862069014, 1161.7117024070208, 1167.8864798301352, 1149.5447927927917, 1167.690074659642, 1222.8968572638778, 1242.0602226804278, 1200.9750000000147, 1180.7577039930775, 1194.8303300471543, 1204.8358861301322, 1073.5188054298685, 1137.537400722025, 1190.8258687258722, 1224.9725899581476, 1085.564811490099, 1140.727018769102, 1181.7470608695614, 1099.7067861827754, 1281.2187625552472, 1163.8689097103766, 1222.178381877061, 1273.1017144026016, 1195.967448680347, 1089.5706905829716, 1150.6694664902961, 1155.7500000000102, 1203.0930147662032, 1225.8365968362536, 1167.751925249906, 1168.8249828326293, 1147.8034453057655, 1183.0001999167364, 1190.0828911704384, 1251.136252545833, 1191.924995780619, 1166.5924955356988, 1122.5548379837671, 1219.0018492294857, 1146.6187144128385, 1209.802409638517, 1148.646693227097, 1153.8861799660165, 1225.1223764801816, 1177.034333609275, 1183.790858869234, 1143.778598615892, 1160.9140684410468, 1181.9393939393938, 1202.9749832635944, 1220.9990624999868, 1190.7579175704984, 1184.811329032259, 1192.9648491198595, 1207.8191244634945, 1076.547799279958, 1134.6274455797309, 1243.172474686095, 1238.060931958785, 1246.2224186420376, 1167.7108358862486, 1086.4050000000016, 1150.5972098214581, 1099.6017484388929, 1211.004933388846, 1136.612178173729, 1238.8634368353637, 1061.3172355430256, 1076.263461538441, 1163.6254529307275, 1176.5938492417463, 1192.0905332239313, 1198.0680065897773]
Traceback (most recent call last):
  File "criteo_main_replay.py", line 222, in <module>
    reward = Algo_main(np.array(D), config.B, config.N, _D, _algo, mode, modify=modify)
  File "criteo_main_replay.py", line 46, in Algo_main
    Algo_UCB.UCB(D_i=D_n, n=n, _UCB=_algo)
  File "../criteo_data/Algo_UCB.py", line 41, in UCB
    _UCB.Theta[a] = np.dot(np.linalg.inv(_UCB.Fai[a]), _UCB.B_aj[a])
  File "<__array_function__ internals>", line 6, in inv
  File "/home/haonan_jia/SRG-DQN-Pendulum/venv/lib/python3.5/site-packages/numpy/linalg/linalg.py", line 547, in inv
    ainv = _umath_linalg.inv(a, signature=signature, extobj=extobj)
  File "/home/haonan_jia/SRG-DQN-Pendulum/venv/lib/python3.5/site-packages/numpy/linalg/linalg.py", line 97, in _raise_linalgerror_singular
    raise LinAlgError("Singular matrix")
numpy.linalg.LinAlgError: Singular matrix
